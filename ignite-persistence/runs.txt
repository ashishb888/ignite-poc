RUN 1

2019-12-23 18:01:03.958  INFO 166755 --- [           main] poc.ignite.IgniteApp                     : Started IgniteApp in 7.261 seconds (JVM running for 7.733)
2019-12-23 18:01:03.959  INFO 166755 --- [           main] poc.ignite.IgniteApp                     : run service
2019-12-23 18:01:03.959 DEBUG 166755 --- [           main] poc.ignite.service.IgniteService         : main service
2019-12-23 18:01:03.960 DEBUG 166755 --- [           main] p.i.service.SimplePersistenceService     : main service
2019-12-23 18:01:03.960 DEBUG 166755 --- [           main] p.i.service.SimplePersistenceService     : start service
2019-12-23 18:01:03.971 DEBUG 166755 --- [           main] poc.ignite.repos.CacheRepository         : personCache repo

[user@host ~]$ $IGNITE_HOME/bin/sqlline.sh --verbose=true -u jdbc:ignite:thin://localhost:10800
issuing: !connect jdbc:ignite:thin://localhost:10800 '' '' org.apache.ignite.IgniteJdbcThinDriver
Connecting to jdbc:ignite:thin://localhost:10800
Connected to: Apache Ignite (version 2.6.0#20180710-sha1:669feacc)
Driver: Apache Ignite Thin JDBC Driver (version 8.7.6#20190704-sha1:6449a674)
Autocommit status: true
Transaction isolation: TRANSACTION_REPEATABLE_READ
sqlline version 1.3.0
0: jdbc:ignite:thin://localhost:10800>
0: jdbc:ignite:thin://localhost:10800> select count(*) from "STS".person;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 500                            |
+--------------------------------+

----------==----------

RUN 2

[user@host apache-ignite-fabric-2.6.0-bin]$ bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 7

Baseline nodes:
    ConsistentID=2dc61561-1e46-48cf-a036-06d9f0467438, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 1

Other nodes:
    ConsistentID=e465d475-8ce6-47a2-8b33-0dedf5a0e526
Number of other nodes: 1
[user@host apache-ignite-fabric-2.6.0-bin]$
[user@host apache-ignite-fabric-2.6.0-bin]$

----------==----------
RUN 3

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node1 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar
[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node2 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar
[user@host ignite-persistence]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-0.0.1-SNAPSHOT.jar

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 3

Baseline nodes:
    ConsistentID=b72461e5-5076-42aa-8444-95e385a806b4, STATE=ONLINE
    ConsistentID=cc76676c-4eb8-450d-8853-4faeb9acf671, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.
[user@host apache-ignite-fabric-2.6.0-bin]$


----------==----------
RUN 4

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 10

Baseline nodes:
    ConsistentID=b72461e5-5076-42aa-8444-95e385a806b4, STATE=ONLINE
    ConsistentID=cc76676c-4eb8-450d-8853-4faeb9acf671, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.

----------After killing a node----------

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 11

Baseline nodes:
    ConsistentID=b72461e5-5076-42aa-8444-95e385a806b4, STATE=ONLINE
    ConsistentID=cc76676c-4eb8-450d-8853-4faeb9acf671, STATE=OFFLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.
[user@host apache-ignite-fabric-2.6.0-bin]$

----------==----------
RUN 5

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh  --activate
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster activated
[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 4

Baseline nodes:
    ConsistentID=2ecd6f67-c7e6-49bf-86de-efbe407f6496, STATE=ONLINE
    ConsistentID=b8067f87-201f-4083-bd87-ec817801884c, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.
[user@host apache-ignite-fabric-2.6.0-bin]$

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --state
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster is active
[user@host apache-ignite-fabric-2.6.0-bin]$


[user@host apache-ignite-fabric-2.6.0-bin]$ $IGNITE_HOME/bin/sqlline.sh --verbose=true -u jdbc:ignite:thin://host
issuing: !connect jdbc:ignite:thin://host '' '' org.apache.ignite.IgniteJdbcThinDriver
Connecting to jdbc:ignite:thin://host
Connected to: Apache Ignite (version 2.6.0#20180710-sha1:669feacc)
Driver: Apache Ignite Thin JDBC Driver (version 2.6.0#20180710-sha1:669feacc)
Autocommit status: true
Transaction isolation: TRANSACTION_REPEATABLE_READ
sqlline version 1.3.0
0: jdbc:ignite:thin://host> !tables
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|           TABLE_CAT            |          TABLE_SCHEM           |           TABLE_NAME           |           TABLE_TYPE           |            REMARKS             |            TYPE_CAT          |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|                                | STS                            | PERSON                         | TABLE                          |                                |                              |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
0: jdbc:ignite:thin://host> select count(*) from "STS".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 10                             |
+--------------------------------+
1 row selected (0.156 seconds)
0: jdbc:ignite:thin://host> select * from "STS".PERSON;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 1                              | 1                              | p1                             |
| 2                              | 2                              | p2                             |
| 7                              | 7                              | p7                             |
| 8                              | 8                              | p8                             |
| 0                              | 0                              | p0                             |
| 3                              | 3                              | p3                             |
| 4                              | 4                              | p4                             |
| 5                              | 5                              | p5                             |
| 6                              | 6                              | p6                             |
| 9                              | 9                              | p9                             |
+--------------------------------+--------------------------------+--------------------------------+
10 rows selected (0.029 seconds)
0: jdbc:ignite:thin://host>

----------After killing a node----------

0: jdbc:ignite:thin://host> select * from "STS".PERSON;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 1                              | 1                              | p1                             |
| 2                              | 2                              | p2                             |
| 7                              | 7                              | p7                             |
| 8                              | 8                              | p8                             |
+--------------------------------+--------------------------------+--------------------------------+
4 rows selected (0.014 seconds)
0: jdbc:ignite:thin://host> select count(*) from "STS".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 4                              |
+--------------------------------+
1 row selected (0.005 seconds)
0: jdbc:ignite:thin://host>

----------==----------
RUN 6


0: jdbc:ignite:thin://host:10801> !tables
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|           TABLE_CAT            |          TABLE_SCHEM           |           TABLE_NAME           |           TABLE_TYPE           |            REMARKS             |            TYPE_CAT          |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|                                | STS2                           | PERSON                         | TABLE                          |                                |                              |
|                                | STS1                           | PERSON                         | TABLE                          |                                |                              |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
0: jdbc:ignite:thin://host:10801> select count(*) from "STS1".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 500                            |
+--------------------------------+
1 row selected (0.176 seconds)
0: jdbc:ignite:thin://host:10801> select count(*) from "STS2".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 500                            |
+--------------------------------+
1 row selected (0.013 seconds)
0: jdbc:ignite:thin://host:10801> select * from "STS1".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 1                              | 1                              | p1                             |
| 2                              | 2                              | p2                             |
| 3                              | 3                              | p3                             |
| 4                              | 4                              | p4                             |
| 6                              | 6                              | p6                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.032 seconds)
0: jdbc:ignite:thin://host:10801> select * from "STS2".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 1                              | 1                              | p1                             |
| 2                              | 2                              | p2                             |
| 3                              | 3                              | p3                             |
| 4                              | 4                              | p4                             |
| 6                              | 6                              | p6                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.018 seconds)
0: jdbc:ignite:thin://host:10801>


----------

visor> top
Hosts: 1
+=============================================================================================================================+
| Int./Ext. IPs |   Node ID8(@)    | Node Type |                   OS                   | CPUs |       MACs        | CPU Load |
+=============================================================================================================================+
| 127.0.0.1     | 1: ECC344CE(@n0) | Server    | Linux amd64 3.10.0-957.10.1.el7.x86_64 | 32   | 18:66:DA:E8:44:28 | 0.36 %   |
| 172.17.241.80 | 2: B5BFF9D5(@n1) | Server    |                                        |      | F4:E9:D4:A0:4F:D2 |          |
| 172.17.5.36   | 3: 4926CA7E(@n2) | Client    |                                        |      |                   |          |
+-----------------------------------------------------------------------------------------------------------------------------+

Summary:
+--------------------------------------+
| Active         | true                |
| Total hosts    | 1                   |
| Total nodes    | 3                   |
| Total CPUs     | 32                  |
| Avg. CPU load  | 0.36 %              |
| Avg. free heap | 93.00 %             |
| Avg. Up time   | 00:03:01            |
| Snapshot time  | 2019-12-26 19:40:54 |
+--------------------------------------+
visor> cache
Time of the snapshot: 2019-12-26 19:40:56
+========================================================================================================================+
|      Name(@)       |    Mode     | Nodes |  Entries (Heap / Off-heap)  |   Hits    |  Misses   |   Reads   |  Writes   |
+========================================================================================================================+
| person-cache1(@c0) | PARTITIONED | 2     | min: 247 (0 / 247)          | min: 0    | min: 0    | min: 0    | min: 0    |
|                    |             |       | avg: 250.00 (0.00 / 250.00) | avg: 0.00 | avg: 0.00 | avg: 0.00 | avg: 0.00 |
|                    |             |       | max: 253 (0 / 253)          | max: 0    | max: 0    | max: 0    | max: 0    |
+--------------------+-------------+-------+-----------------------------+-----------+-----------+-----------+-----------+
| person-cache2(@c1) | PARTITIONED | 2     | min: 247 (0 / 247)          | min: 0    | min: 0    | min: 0    | min: 0    |
|                    |             |       | avg: 250.00 (0.00 / 250.00) | avg: 0.00 | avg: 0.00 | avg: 0.00 | avg: 0.00 |
|                    |             |       | max: 253 (0 / 253)          | max: 0    | max: 0    | max: 0    | max: 0    |
+------------------------------------------------------------------------------------------------------------------------+

Use "-a" flag to see detailed statistics.
visor>

visor> node
Select node from:
+=======================================================================================+
| # |       Node ID8(@), IP        | Node Type | Up Time  | CPUs | CPU Load | Free Heap |
+=======================================================================================+
| 0 | ECC344CE(@n0), 172.17.241.80 | Server    | 00:04:13 | 32   | 0.03 %   | 92.00 %   |
| 1 | B5BFF9D5(@n1), 172.17.241.80 | Server    | 00:04:09 | 32   | 0.03 %   | 92.00 %   |
| 2 | 4926CA7E(@n2), 172.17.241.80 | Client    | 00:04:00 | 32   | 0.00 %   | 87.00 %   |
+---------------------------------------------------------------------------------------+

Choose node number ('c' to cancel) [0]:
Detailed statistics (y/n) [n]: y

Time of the snapshot: 2019-12-26 19:42:12
+------------------------------------------------------------------------+
| ID                          | ecc344ce-702c-4351-9779-29deac5bd61b     |
| ID8                         | ECC344CE                                 |
| Node Type                   | Server                                   |
| Order                       | 1                                        |
| Address (0)                 | 172.17.241.80                            |
| Address (1)                 | 172.17.5.36                              |
| Address (2)                 | 127.0.0.1                                |
| OS info                     | Linux amd64 3.10.0-957.10.1.el7.x86_64   |
| OS user                     | user                                   |
| Deployment mode             | SHARED                                   |
| Language runtime            | Java Platform API Specification ver. 1.8 |
| Ignite version              | 2.6.0                                    |
| Ignite instance name        | <default>                                |
| JRE information             | HotSpot 64-Bit Tiered Compilers          |
| JVM start time              | 2019-12-26 19:37:52                      |
| Node start time             | 2019-12-26 19:37:55                      |
| Up time                     | 00:04:19.482                             |
| CPUs                        | 32                                       |
| Last metric update          | 2019-12-26 19:42:11                      |
| Non-loopback IPs            | 172.17.241.80, 172.17.5.36               |
| Enabled MACs                | 1866DAE84428, F4E9D4A04FD2               |
| Maximum active jobs         | 1                                        |
| Current active jobs         | 0                                        |
| Average active jobs         | 0.02                                     |
| Maximum waiting jobs        | 0                                        |
| Current waiting jobs        | 0                                        |
| Average waiting jobs        | 0.00                                     |
| Maximum rejected jobs       | 0                                        |
| Current rejected jobs       | 0                                        |
| Average rejected jobs       | 0.00                                     |
| Maximum cancelled jobs      | 0                                        |
| Current cancelled jobs      | 0                                        |
| Average cancelled jobs      | 0.00                                     |
| Total rejected jobs         | 0                                        |
| Total executed jobs         | 3                                        |
| Total cancelled jobs        | 0                                        |
| Maximum job wait time       | 0ms                                      |
| Current job wait time       | 0ms                                      |
| Average job wait time       | 0.00ms                                   |
| Maximum job execute time    | 493ms                                    |
| Current job execute time    | 0ms                                      |
| Average job execute time    | 164.33ms                                 |
| Total busy time             | 11977ms                                  |
| Busy time %                 | 4.62%                                    |
| Current CPU load %          | 0.00%                                    |
| Average CPU load %          | 0.12%                                    |
| Heap memory initialized     | 1gb                                      |
| Heap memory used            | 69mb                                     |
| Heap memory committed       | 982mb                                    |
| Heap memory maximum         | 982mb                                    |
| Non-heap memory initialized | 2mb                                      |
| Non-heap memory used        | 71mb                                     |
| Non-heap memory committed   | 73mb                                     |
| Non-heap memory maximum     | 0                                        |
| Current thread count        | 124                                      |
| Maximum thread count        | 150                                      |
| Total started thread count  | 196                                      |
| Current daemon thread count | 8                                        |
+------------------------------------------------------------------------+

Data region metrics:
+=====================================================================================================================+
|      Name       | Page size |       Pages        |  Memory   |      Rates       | Checkpoint buffer | Large entries |
+=====================================================================================================================+
| Data_Region     | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+-----------------+-----------+--------------------+-----------+------------------+-------------------+---------------+
| Default_Region  | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+-----------------+-----------+--------------------+-----------+------------------+-------------------+---------------+
| metastoreMemPlc | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+-----------------+-----------+--------------------+-----------+------------------+-------------------+---------------+
| sysMemPlc       | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+---------------------------------------------------------------------------------------------------------------------+

visor> node
Select node from:
+=======================================================================================+
| # |       Node ID8(@), IP        | Node Type | Up Time  | CPUs | CPU Load | Free Heap |
+=======================================================================================+
| 0 | ECC344CE(@n0), 172.17.241.80 | Server    | 00:06:35 | 32   | 0.00 %   | 91.00 %   |
| 1 | B5BFF9D5(@n1), 172.17.241.80 | Server    | 00:06:31 | 32   | 0.00 %   | 90.00 %   |
| 2 | 4926CA7E(@n2), 172.17.241.80 | Client    | 00:06:24 | 32   | 0.00 %   | 76.00 %   |
+---------------------------------------------------------------------------------------+

Choose node number ('c' to cancel) [0]: 1
Detailed statistics (y/n) [n]: y

Time of the snapshot: 2019-12-26 19:44:34
+------------------------------------------------------------------------+
| ID                          | b5bff9d5-259c-48e0-bcb9-5ebadd216a10     |
| ID8                         | B5BFF9D5                                 |
| Node Type                   | Server                                   |
| Order                       | 2                                        |
| Address (0)                 | 172.17.241.80                            |
| Address (1)                 | 172.17.5.36                              |
| Address (2)                 | 127.0.0.1                                |
| OS info                     | Linux amd64 3.10.0-957.10.1.el7.x86_64   |
| OS user                     | user                                   |
| Deployment mode             | SHARED                                   |
| Language runtime            | Java Platform API Specification ver. 1.8 |
| Ignite version              | 2.6.0                                    |
| Ignite instance name        | <default>                                |
| JRE information             | HotSpot 64-Bit Tiered Compilers          |
| JVM start time              | 2019-12-26 19:37:56                      |
| Node start time             | 2019-12-26 19:38:00                      |
| Up time                     | 00:06:37.528                             |
| CPUs                        | 32                                       |
| Last metric update          | 2019-12-26 19:44:34                      |
| Non-loopback IPs            | 172.17.241.80, 172.17.5.36               |
| Enabled MACs                | 1866DAE84428, F4E9D4A04FD2               |
| Maximum active jobs         | 0                                        |
| Current active jobs         | 0                                        |
| Average active jobs         | 0.00                                     |
| Maximum waiting jobs        | 0                                        |
| Current waiting jobs        | 0                                        |
| Average waiting jobs        | 0.00                                     |
| Maximum rejected jobs       | 0                                        |
| Current rejected jobs       | 0                                        |
| Average rejected jobs       | 0.00                                     |
| Maximum cancelled jobs      | 0                                        |
| Current cancelled jobs      | 0                                        |
| Average cancelled jobs      | 0.00                                     |
| Total rejected jobs         | 0                                        |
| Total executed jobs         | 2                                        |
| Total cancelled jobs        | 0                                        |
| Maximum job wait time       | 0ms                                      |
| Current job wait time       | 0ms                                      |
| Average job wait time       | 0.00ms                                   |
| Maximum job execute time    | 10ms                                     |
| Current job execute time    | 0ms                                      |
| Average job execute time    | 5.00ms                                   |
| Total busy time             | 4125ms                                   |
| Busy time %                 | 1.04%                                    |
| Current CPU load %          | 0.03%                                    |
| Average CPU load %          | 0.10%                                    |
| Heap memory initialized     | 1gb                                      |
| Heap memory used            | 92mb                                     |
| Heap memory committed       | 982mb                                    |
| Heap memory maximum         | 982mb                                    |
| Non-heap memory initialized | 2mb                                      |
| Non-heap memory used        | 71mb                                     |
| Non-heap memory committed   | 73mb                                     |
| Non-heap memory maximum     | 0                                        |
| Current thread count        | 145                                      |
| Maximum thread count        | 156                                      |
| Total started thread count  | 220                                      |
| Current daemon thread count | 8                                        |
+------------------------------------------------------------------------+

Data region metrics:
+=====================================================================================================================+
|      Name       | Page size |       Pages        |  Memory   |      Rates       | Checkpoint buffer | Large entries |
+=====================================================================================================================+
| Data_Region     | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+-----------------+-----------+--------------------+-----------+------------------+-------------------+---------------+
| Default_Region  | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+-----------------+-----------+--------------------+-----------+------------------+-------------------+---------------+
| metastoreMemPlc | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+-----------------+-----------+--------------------+-----------+------------------+-------------------+---------------+
| sysMemPlc       | 0         | Total:  0          | Total:  0 | Allocation: 0.00 | Pages: 0          | 0.00%         |
|                 |           | Dirty:  0          | In RAM: 0 | Eviction:   0.00 | Size:  0          |               |
|                 |           | Memory: 0          |           | Replace:    0.00 |                   |               |
|                 |           | Fill factor: 0.00% |           |                  |                   |               |
+---------------------------------------------------------------------------------------------------------------------+

visor>


----------==----------
RUN 7: Multiple data regions

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node1 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node2 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-0.0.1-SNAPSHOT.jar

0: jdbc:ignite:thin://host:10801> !tables
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|           TABLE_CAT            |          TABLE_SCHEM           |           TABLE_NAME           |           TABLE_TYPE           |            REMARKS             |            TYPE_CAT          |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|                                | STS2                           | PERSON                         | TABLE                          |                                |                              |
|                                | STS1                           | PERSON                         | TABLE                          |                                |                              |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
0: jdbc:ignite:thin://host:10801> select count(*) from "STS1".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 500                            |
+--------------------------------+
1 row selected (0.168 seconds)
0: jdbc:ignite:thin://host:10801> select count(*) from "STS2".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 500                            |
+--------------------------------+
1 row selected (0.012 seconds)
0: jdbc:ignite:thin://host:10801> select * from "STS1".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 0                              | 0                              | p0                             |
| 2                              | 2                              | p2                             |
| 6                              | 6                              | p6                             |
| 7                              | 7                              | p7                             |
| 9                              | 9                              | p9                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.03 seconds)
0: jdbc:ignite:thin://host:10801> select * from "STS2".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 0                              | 0                              | p0                             |
| 2                              | 2                              | p2                             |
| 6                              | 6                              | p6                             |
| 7                              | 7                              | p7                             |
| 9                              | 9                              | p9                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.02 seconds)
0: jdbc:ignite:thin://host:10801>


----------After restarting the cluster----------
STS1.PERSON has gone as it was stored on Default_Region which was not persisted


0: jdbc:ignite:thin://host:10800> !tables
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|           TABLE_CAT            |          TABLE_SCHEM           |           TABLE_NAME           |           TABLE_TYPE           |            REMARKS             |            TYPE_CAT          |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|                                | STS2                           | PERSON                         | TABLE                          |                                |                              |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
0: jdbc:ignite:thin://host:10800> select count(*) from "STS2".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 500                            |
+--------------------------------+
1 row selected (0.161 seconds)
0: jdbc:ignite:thin://host:10800> select * from "STS2".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 1                              | 1                              | p1                             |
| 3                              | 3                              | p3                             |
| 4                              | 4                              | p4                             |
| 5                              | 5                              | p5                             |
| 8                              | 8                              | p8                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.055 seconds)
0: jdbc:ignite:thin://host:10800>

----------==----------
RUN 8: Backups

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node1 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node2 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-0.0.1-SNAPSHOT.jar

2019-12-27 16:37:54.546  INFO 141624 --- [ange-worker-#97] o.a.i.i.p.cache.GridCacheProcessor       : Started cache [name=ignite-sys-cache, id=-2100569601, memoryPolicyName=sysMemPlc, mode=REPLICATED, atomicity=TRANSACTIONAL, backups=2147483647]
2019-12-27 16:37:54.943  INFO 141624 --- [ange-worker-#97] o.a.i.i.p.cache.GridCacheProcessor       : Started cache [name=person-cache1, id=1419351655, memoryPolicyName=Default_Region, mode=PARTITIONED, atomicity=ATOMIC, backups=1]
2019-12-27 16:37:55.326  INFO 141624 --- [ange-worker-#97] o.a.i.i.p.cache.GridCacheProcessor       : Started cache [name=person-cache2, id=1419351656, memoryPolicyName=Data_Region, mode=PARTITIONED, atomicity=ATOMIC, backups=1]


----------==----------
RUN 9: Data nodes & worker nodes

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node1 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node2 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-0.0.1-SNAPSHOT.jar

[user@host ignite-persistence-worker-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-worker-node-0.0.1-SNAPSHOT.jar



[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 4

Baseline nodes:
    ConsistentID=36586157-d17b-44af-b861-9f8b05a2f603, STATE=ONLINE
    ConsistentID=da4f789d-b7b0-4b12-a95b-628c9fcf56f9, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.
[user@host apache-ignite-fabric-2.6.0-bin]$
[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 5

Baseline nodes:
    ConsistentID=36586157-d17b-44af-b861-9f8b05a2f603, STATE=ONLINE
    ConsistentID=da4f789d-b7b0-4b12-a95b-628c9fcf56f9, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes:
    ConsistentID=127.0.0.1,172.17.241.80,172.17.5.36:42502
Number of other nodes: 1

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 9

Baseline nodes:
    ConsistentID=36586157-d17b-44af-b861-9f8b05a2f603, STATE=ONLINE
    ConsistentID=da4f789d-b7b0-4b12-a95b-628c9fcf56f9, STATE=OFFLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.

----------After all persistence nodes down. And one of them has started hence cluster state is inactive----------

[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: inactive
Current topology version: 1

Baseline nodes:
    ConsistentID=36586157-d17b-44af-b861-9f8b05a2f603, STATE=ONLINE
    ConsistentID=da4f789d-b7b0-4b12-a95b-628c9fcf56f9, STATE=OFFLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.
[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 2

Baseline nodes:
    ConsistentID=36586157-d17b-44af-b861-9f8b05a2f603, STATE=ONLINE
    ConsistentID=da4f789d-b7b0-4b12-a95b-628c9fcf56f9, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes not found.
[user@host apache-ignite-fabric-2.6.0-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.6.0#20180710-sha1:669feacc]
2018 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 3

Baseline nodes:
    ConsistentID=36586157-d17b-44af-b861-9f8b05a2f603, STATE=ONLINE
    ConsistentID=da4f789d-b7b0-4b12-a95b-628c9fcf56f9, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 2

Other nodes:
    ConsistentID=127.0.0.1,172.17.241.80,172.17.5.36:42502
Number of other nodes: 1


[user@host ~]$ $IGNITE_HOME/bin/sqlline.sh --verbose=true -u jdbc:ignite:thin://host:10800
issuing: !connect jdbc:ignite:thin://host:10800 '' '' org.apache.ignite.IgniteJdbcThinDriver
Connecting to jdbc:ignite:thin://host:10800
Connected to: Apache Ignite (version 2.7.6#20190911-sha1:21f7ca41)
Driver: Apache Ignite Thin JDBC Driver (version 2.6.0#20180710-sha1:669feacc)
Autocommit status: true
Transaction isolation: TRANSACTION_REPEATABLE_READ
sqlline version 1.3.0
0: jdbc:ignite:thin://host:10800> !tables
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|           TABLE_CAT            |          TABLE_SCHEM           |           TABLE_NAME           |           TABLE_TYPE           |            REMARKS             |            TYPE_CAT          |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|                                | STS1                           | PERSON                         | TABLE                          |                                |                              |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
0: jdbc:ignite:thin://host:10800> select count(*) from "STS1".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 5000                           |
+--------------------------------+
1 row selected (0.2 seconds)
0: jdbc:ignite:thin://host:10800> select * from "STS1".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 1                              | 1                              | p1                             |
| 2                              | 2                              | p2                             |
| 3                              | 3                              | p3                             |
| 4                              | 4                              | p4                             |
| 5                              | 5                              | p5                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.03 seconds)
0: jdbc:ignite:thin://host:10800> Closing: org.apache.ignite.internal.jdbc.thin.JdbcThinConnection
[user@host ~]$ $IGNITE_HOME/bin/sqlline.sh --verbose=true -u jdbc:ignite:thin://host:10803
issuing: !connect jdbc:ignite:thin://host:10803 '' '' org.apache.ignite.IgniteJdbcThinDriver
Connecting to jdbc:ignite:thin://host:10803
Connected to: Apache Ignite (version 2.7.6#20190911-sha1:21f7ca41)
Driver: Apache Ignite Thin JDBC Driver (version 2.6.0#20180710-sha1:669feacc)
Autocommit status: true
Transaction isolation: TRANSACTION_REPEATABLE_READ
sqlline version 1.3.0
0: jdbc:ignite:thin://host:10803> !tables
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|           TABLE_CAT            |          TABLE_SCHEM           |           TABLE_NAME           |           TABLE_TYPE           |            REMARKS             |            TYPE_CAT          |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
|                                | STS2                           | PERSON                         | TABLE                          |                                |                              |
+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+------------------------------+
0: jdbc:ignite:thin://host:10803> select count(*) from "STS2".PERSON;
+--------------------------------+
|            COUNT(*)            |
+--------------------------------+
| 5000                           |
+--------------------------------+
1 row selected (0.129 seconds)
0: jdbc:ignite:thin://host:10803> select * from "STS2".PERSON limit 5;
+--------------------------------+--------------------------------+--------------------------------+
|               ID               |             CITYID             |              NAME              |
+--------------------------------+--------------------------------+--------------------------------+
| 0                              | 0                              | p0                             |
| 1                              | 1                              | p1                             |
| 2                              | 2                              | p2                             |
| 3                              | 3                              | p3                             |
| 4                              | 4                              | p4                             |
+--------------------------------+--------------------------------+--------------------------------+
5 rows selected (0.026 seconds)


----------==----------
RUN 10: Forming baseline topology

Step 1:

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node1 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar
[user@host apache-ignite-2.7.6-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.7.6#20190911-sha1:21f7ca41]
2019 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: inactive
Current topology version: 1

Baseline nodes not found.

Step 2:

[user@host ignite-persistence]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-0.0.1-SNAPSHOT.jar
[user@host apache-ignite-2.7.6-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.7.6#20190911-sha1:21f7ca41]
2019 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 2

Baseline nodes:
    ConsistentID=56da6d21-759f-4220-89a0-26557e2fd8fc, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 1

Other nodes not found.

Step 3:

[user@host ignite-persistence-data-node]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G -Dlogging.file=/var/tmp/logs/ignite-persistence-data-node/ignite-persistence-data-node2 -jar ignite-persistence-data-node-0.0.1-SNAPSHOT.jar
[user@host apache-ignite-2.7.6-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.7.6#20190911-sha1:21f7ca41]
2019 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 4

Baseline nodes:
    ConsistentID=56da6d21-759f-4220-89a0-26557e2fd8fc, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 1

Other nodes:
    ConsistentID=32963c74-dab0-4b89-aba8-84c3f85a61d7
Number of other nodes: 1

Step 4:

[user@host ignite-persistence]$ $JAVA_HOME/bin/java -Xms1G -Xmx1G  -jar ignite-persistence-0.0.1-SNAPSHOT.jar

[user@host apache-ignite-2.7.6-bin]$ ./bin/control.sh --baseline
Control utility [ver. 2.7.6#20190911-sha1:21f7ca41]
2019 Copyright(C) Apache Software Foundation
User: user
--------------------------------------------------------------------------------
Cluster state: active
Current topology version: 5

Baseline nodes:
    ConsistentID=56da6d21-759f-4220-89a0-26557e2fd8fc, STATE=ONLINE
--------------------------------------------------------------------------------
Number of baseline nodes: 1

Other nodes:
    ConsistentID=32963c74-dab0-4b89-aba8-84c3f85a61d7
Number of other nodes: 1


----------==----------
RUN 11: Disabling WAL archive with below versions works slow 

		<ignite.version>2.5.14</ignite.version>
		<h2.version>1.4.195</h2.version>
		<gridgain.version>8.5.14</gridgain.version>


user@host tmp]$ ls -lrth /opt/ngs/db/wal/node00-a61bb471-3b77-44b8-8bb6-c68afd123819/
total 4.0G
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:45 0000000000000008.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:46 0000000000000009.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:47 0000000000000010.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:47 0000000000000011.wal
user@host tmp]$


user@host tmp]$ ls -lrth /opt/ngs/db/wal/node01-8ea0b60c-d6e6-46d6-987a-dd6207992a51/
total 5.0G
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:45 0000000000000008.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:45 0000000000000009.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:46 0000000000000010.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:47 0000000000000011.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 16:48 0000000000000012.wal
user@host tmp]$

----------==----------
RUN 12: Disabling WAL archive with below versions works fast
	
	<ignite.version>2.7.6</ignite.version>
	<h2.version>1.4.197</h2.version> 

user@host tmp]$ ls -lrth /opt/ngs/db/wal/node00-949e1e87-540c-4fc2-919f-c1702099adfb/
total 2.0G
-rw-r----- 1 hdpusr nse 1.0G Jan 16 17:02 0000000000000000.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 17:02 0000000000000001.wal
user@host tmp]$
user@host tmp]$
user@host tmp]$ ls -lrth /opt/ngs/db/wal/node00-949e1e87-540c-4fc2-919f-c1702099adfb/
total 2.0G
-rw-r----- 1 hdpusr nse 1.0G Jan 16 17:03 0000000000000001.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 17:03 0000000000000002.wal
user@host tmp]$ ls -lrth /opt/ngs/db/wal/node01-3e4c45b1-a803-4ea2-b37f-ba37884b9c19/
total 2.0G
-rw-r----- 1 hdpusr nse 1.0G Jan 16 17:02 0000000000000001.wal
-rw-r----- 1 hdpusr nse 1.0G Jan 16 17:03 0000000000000002.wal
user@host tmp]$

